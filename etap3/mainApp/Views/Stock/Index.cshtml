@model List<Platformy_Programowania_1.Models.Company>
<script type="text/javascript" src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="https://cdn.canvasjs.com/canvasjs.stock.min.js"></script>
<script type="text/javascript">

@{
    string razorData = (string)(TempData["YearlyData"]);
}

window.onload = function () {
    var jsonData = '@Html.Raw(razorData)';
    // Parsowanie danych z ciągu tekstowego JSON
    var data = JSON.parse(jsonData);
    var dataPoints = [], y = 0, x = new Date(2016, 0, 02).getTime(), oneDayInms = (24 * 60 * 60 * 1000);
    var stockChart = new CanvasJS.StockChart("stockChartContainer", {
        backgroundColor: "#2d2c38",
        height: 800,
        title: {
            text: '@Html.Raw((string)(TempData["Title"]))',
            fontSize: 30,
            fontColor: "white",
            padding: 5,
            borderThickness: 4,
            cornerRadius: 8,
            borderColor: "#3763f4",
            backgroundColor: "#27262e",
        },
        charts: [{
            data: [{
                xValueType: "dateTime",
                type: "line",
                dataPoints: dataPoints
            }]
        }],
        rangeSelector: {
            buttons: [],
            inputFields: {
                enabled: false
            }
        }
    });

    for (var i = 0; i < data.length; i++) {
        dataPoints.push({ x: new Date(data[i].Dzien), y: Number(data[i].Cena) });
    }
    stockChart.render();
}
</script>

<div class="container-fluid text-secondary" style="width:50%;">
    @using (Html.BeginForm("GetData", "Stock", FormMethod.Post))
    {
        @Html.DropDownList("ID_firmy", new SelectList(Model, "ID_firmy", "Nazwa_firmy"), "Wybierz firmę", new { @class = "form-control" })
        <button class="btn btn-primary" type="submit">Pobierz dane</button>
    }

    
</div>
<div class="container-fluid text-secondary" style="height: 50px; width:90%;">
    <div id="stockChartContainer"></div>
</div>
